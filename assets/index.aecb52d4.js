import{d as gt,j as y,o as W,c as H,e as b,t as wt,P as zt,n as xt,q as Vt,S as Yt,K as Ht,L as vt,m as Q,R as Xt,D as ft,U as G,V as Bt,W as V,b as A,f as Y,v as Dt,z as ot,F as st,X as Nt,i as dt,Y as jt,I as Ut,r as Rt,E as Qt,Z as qt}from"./index.12dd4ed4.js";import Zt from"./Header.2e47836d.js";import Kt from"./Left.80370e95.js";const Ot={ref:"content",class:"overflow-auto pl-4"},Gt=gt({__name:"Collapse",props:{title:{type:String,default:"title"}},setup(v){const o=v,t=y(!1),e=()=>{t.value=!t.value};return(s,n)=>(W(),H("div",null,[b("div",{class:"hover:bg-[var(--panel-hover-bg-color)] rounded-md select-none flex justify-between leading-10 h-10 items-center mx-2 px-2 py-1 cursor-pointer",onClick:e},[b("div",null,wt(o.title),1),b("div",{i:"carbon-caret-up",class:zt([t.value?"rotate-180":"rotate-90","transition ease-in-out duration-200"])},null,2)]),xt(b("div",Ot,[Yt(s.$slots,"default")],512),[[Vt,t.value]])]))}}),Jt=/^[\t\n\f\r ]*([MLHVZCSQTAmlhvzcsqta])[\t\n\f\r ]*/,Pt=/^[01]/,nt=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,h=nt,te=/^(([\t\n\f\r ]+,?[\t\n\f\r ]*)|(,[\t\n\f\r ]*))/,ee={M:[h,h],L:[h,h],H:[h],V:[h],Z:[],C:[h,h,h,h,h,h],S:[h,h,h,h],Q:[h,h,h,h],T:[h,h],A:[nt,nt,h,Pt,Pt,h,h]};class at{static components(o,t,e){const s=ee[o.toUpperCase()],n=[];for(;e<=t.length;){const u=[o];for(const f of s){const x=t.slice(e).match(f);if(x!==null){u.push(x[0]),e+=x[0].length;const c=t.slice(e).match(te);c!==null&&(e+=c[0].length)}else{if(u.length===1)return[e,n];throw new Error("malformed path (first error at "+e+")")}}if(n.push(u),s.length===0)return[e,n];o==="m"&&(o="l"),o==="M"&&(o="L")}throw new Error("malformed path (first error at "+e+")")}static parse(o){let t=0,e=[];for(;t<o.length;){const s=o.slice(t).match(Jt);if(s!==null){const n=s[1];t+=s[0].length;const u=at.components(n,o,t);t=u[0],e=[...e,...u[1]]}else throw new Error("malformed path (first error at "+t+")")}return e}}class pt{constructor(o){const t=at.parse(o);this.path=t.map(e=>C.Make(e)),this.refreshAbsolutePositions()}asString(o=4,t=!1){return this.path.reduce((e,s)=>{const n=s.getType();if(t&&e.length>0){const u=e[e.length-1];if(u.type===n)return u.trailing.push(s),e}return e.push({type:n==="m"?"l":n==="M"?"L":n,item:s,trailing:[]}),e},[]).map(e=>{const s=e.item.asString(o,t,e.trailing);return t?s.replace(/^([a-z]) /i,"$1").replace(/ -/g,"-").replace(/(\.[0-9]+) (?=\.)/g,"$1"):s}).join(t?"":" ")}delete(o){const t=this.path.indexOf(o);return t!==-1&&(this.path.splice(t,1),this.refreshAbsolutePositions()),this}targetLocations(){return this.path.map(o=>o.targetLocation())}controlLocations(){let o=[];for(let t=1;t<this.path.length;++t){const e=this.path[t].controlLocations();e.forEach((s,n)=>{s.subIndex=n}),o=[...o,...e]}return o}setLocation(o,t){o instanceof S?o.itemReference.setControlLocation(o.subIndex,t):o.itemReference.setTargetLocation(t),this.refreshAbsolutePositions()}refreshAbsolutePositions(){let o=null,t=new g(0,0);for(const e of this.path)e.refreshAbsolutePoints(t,o),e.refreshAbsoluteControlPoints(t,o),e.absolutePoints.forEach(s=>s.itemReference=e),e.absoluteControlPoints.forEach(s=>s.itemReference=e),(e instanceof B||e instanceof D)&&(t=e.targetLocation()),o=e}}function mt(v,o,t=!1){let e=v.toFixed(o).replace(/^(-?[0-9]*\.([0-9]*[1-9])?)0*$/,"$1").replace(/\.$/,"");return t&&(e=e.replace(/^(-?)0\./,"$1.")),e}class g{constructor(o,t){this.x=o,this.y=t}}class M extends g{constructor(o,t,e=!0){super(o,t),this.itemReference=new oe,this.movable=!0,this.movable=e}}class S extends M{constructor(o,t,e=!0){super(o.x,o.y,e),this.relations=t,this.subIndex=0}}class C{constructor(o,t){this.previousPoint=new g(0,0),this.absolutePoints=[],this.absoluteControlPoints=[],this.values=o,this.relative=t}static Make(o){let t;const e=o[0].toUpperCase()!==o[0],s=o.slice(1).map(n=>parseFloat(n));switch(o[0].toUpperCase()){case B.key:t=new B(s,e);break;case q.key:t=new q(s,e);break;case Z.key:t=new Z(s,e);break;case K.key:t=new K(s,e);break;case D.key:t=new D(s,e);break;case _.key:t=new _(s,e);break;case T.key:t=new T(s,e);break;case E.key:t=new E(s,e);break;case X.key:t=new X(s,e);break;case O.key:t=new O(s,e);break}if(!t)throw"Invalid SVG item";return t}static MakeFrom(o,t,e){const s=o.targetLocation(),n=s.x.toString(),u=s.y.toString();let f=[];const x=e.toUpperCase();switch(x){case B.key:f=[B.key,n,u];break;case q.key:f=[q.key,n,u];break;case Z.key:f=[Z.key,n];break;case K.key:f=[K.key,u];break;case D.key:f=[D.key];break;case _.key:f=[_.key,"0","0","0","0",n,u];break;case T.key:f=[T.key,"0","0",n,u];break;case E.key:f=[E.key,"0","0",n,u];break;case X.key:f=[X.key,n,u];break;case O.key:f=[O.key,"1","1","0","0","0",n,u];break}const c=C.Make(f),w=o.absoluteControlPoints;return c.previousPoint=t.targetLocation(),c.absolutePoints=[s],c.resetControlPoints(t),(o instanceof _||o instanceof T)&&(c instanceof _||c instanceof T)&&(c instanceof _&&(c.values[0]=w[0].x,c.values[1]=w[0].y,c.values[2]=w[1].x,c.values[3]=w[1].y),c instanceof T&&(c.values[0]=w[1].x,c.values[1]=w[1].y)),(o instanceof E||o instanceof X)&&c instanceof E&&(c.values[0]=w[0].x,c.values[1]=w[0].y),e!==x&&c.setRelative(!0),c}refreshAbsolutePoints(o,t){this.previousPoint=t?t.targetLocation():new g(0,0),this.absolutePoints=[];let e=t?t.targetLocation():new g(0,0);this.relative||(e=new g(0,0));for(let s=0;s<this.values.length-1;s+=2)this.absolutePoints.push(new M(e.x+this.values[s],e.y+this.values[s+1]))}setRelative(o){this.relative!==o&&(this.relative=!1,o?(this.translate(-this.previousPoint.x,-this.previousPoint.y),this.relative=!0):this.translate(this.previousPoint.x,this.previousPoint.y))}refreshAbsoluteControlPoints(o,t){this.absoluteControlPoints=[]}resetControlPoints(o){}translate(o,t,e=!1){(!this.relative||e)&&this.values.forEach((s,n)=>{this.values[n]=s+(n%2===0?o:t)})}scale(o,t){this.values.forEach((e,s)=>{this.values[s]=e*(s%2===0?o:t)})}targetLocation(){const o=this.absolutePoints.length;return this.absolutePoints[o-1]}setTargetLocation(o){const t=this.targetLocation(),e=o.x-t.x,s=o.y-t.y,n=this.values.length;this.values[n-2]+=e,this.values[n-1]+=s}setControlLocation(o,t){const e=this.absolutePoints[o],s=t.x-e.x,n=t.y-e.y;this.values[2*o]+=s,this.values[2*o+1]+=n}controlLocations(){return this.absoluteControlPoints}getType(){let o=this.constructor.key;return this.relative&&(o=o.toLowerCase()),o}asStandaloneString(){return["M",this.previousPoint.x,this.previousPoint.y,this.getType(),...this.values].join(" ")}asString(o=4,t=!1,e=[]){const s=[this.values,...e.map(n=>n.values)].reduce((n,u)=>n.concat(u),[]).map(n=>mt(n,o,t));return[this.getType(),...s].join(" ")}}class oe extends C{constructor(){super([],!1)}}class B extends C{}B.key="M";class q extends C{}q.key="L";class _ extends C{refreshAbsoluteControlPoints(o,t){if(!t)throw"Invalid path";this.absoluteControlPoints=[new S(this.absolutePoints[0],[t.targetLocation()]),new S(this.absolutePoints[1],[this.targetLocation()])]}resetControlPoints(o){const t=o.targetLocation(),e=this.targetLocation(),s=this.relative?t:new g(0,0);this.values[0]=2*t.x/3+e.x/3-s.x,this.values[1]=2*t.y/3+e.y/3-s.y,this.values[2]=t.x/3+2*e.x/3-s.x,this.values[3]=t.y/3+2*e.y/3-s.y}}_.key="C";const yt=class extends C{refreshAbsoluteControlPoints(v,o){if(this.absoluteControlPoints=[],o instanceof _||o instanceof yt){const t=o.targetLocation(),e=o.absoluteControlPoints[1],s=new g(2*t.x-e.x,2*t.y-e.y);this.absoluteControlPoints.push(new S(s,[t],!1))}else{const t=o?o.targetLocation():new g(0,0),e=new g(t.x,t.y);this.absoluteControlPoints.push(new S(e,[],!1))}this.absoluteControlPoints.push(new S(this.absolutePoints[0],[this.targetLocation()]))}asStandaloneString(){return["M",this.previousPoint.x,this.previousPoint.y,"C",this.absoluteControlPoints[0].x,this.absoluteControlPoints[0].y,this.absoluteControlPoints[1].x,this.absoluteControlPoints[1].y,this.absolutePoints[1].x,this.absolutePoints[1].y].join(" ")}resetControlPoints(v){const o=v.targetLocation(),t=this.targetLocation(),e=this.relative?o:new g(0,0);this.values[0]=o.x/3+2*t.x/3-e.x,this.values[1]=o.y/3+2*t.y/3-e.y}setControlLocation(v,o){const t=this.absoluteControlPoints[1],e=o.x-t.x,s=o.y-t.y;this.values[0]+=e,this.values[1]+=s}};let T=yt;T.key="S";class E extends C{refreshAbsoluteControlPoints(o,t){if(!t)throw"Invalid path";this.absoluteControlPoints=[new S(this.absolutePoints[0],[t.targetLocation(),this.targetLocation()])]}resetControlPoints(o){const t=o.targetLocation(),e=this.targetLocation(),s=this.relative?t:new g(0,0);this.values[0]=t.x/2+e.x/2-s.x,this.values[1]=t.y/2+e.y/2-s.y}}E.key="Q";const bt=class extends C{refreshAbsoluteControlPoints(v,o){if(o instanceof E||o instanceof bt){const t=o.targetLocation(),e=o.absoluteControlPoints[0],s=new g(2*t.x-e.x,2*t.y-e.y);this.absoluteControlPoints=[new S(s,[t,this.targetLocation()],!1)]}else{const t=o?o.targetLocation():new g(0,0),e=new g(t.x,t.y);this.absoluteControlPoints=[new S(e,[],!1)]}}asStandaloneString(){return["M",this.previousPoint.x,this.previousPoint.y,"Q",this.absoluteControlPoints[0].x,this.absoluteControlPoints[0].y,this.absolutePoints[0].x,this.absolutePoints[0].y].join(" ")}};let X=bt;X.key="T";class D extends C{refreshAbsolutePoints(o,t){this.previousPoint=t?t.targetLocation():new g(0,0),this.absolutePoints=[new M(o.x,o.y,!1)]}}D.key="Z";class Z extends C{refreshAbsolutePoints(o,t){this.previousPoint=t?t.targetLocation():new g(0,0),this.relative?this.absolutePoints=[new M(this.values[0]+this.previousPoint.x,this.previousPoint.y)]:this.absolutePoints=[new M(this.values[0],this.previousPoint.y)]}setTargetLocation(o){const t=this.targetLocation(),e=o.x-t.x;this.values[0]+=e}}Z.key="H";class K extends C{translate(o,t,e=!1){this.relative||(this.values[0]+=t)}scale(o,t){this.values[0]*=t}refreshAbsolutePoints(o,t){this.previousPoint=t?t.targetLocation():new g(0,0),this.relative?this.absolutePoints=[new M(this.previousPoint.x,this.values[0]+this.previousPoint.y)]:this.absolutePoints=[new M(this.previousPoint.x,this.values[0])]}setTargetLocation(o){const t=this.targetLocation(),e=o.y-t.y;this.values[0]+=e}}K.key="V";class O extends C{translate(o,t,e=!1){this.relative||(this.values[5]+=o,this.values[6]+=t)}scale(o,t){const e=this.values[0],s=this.values[1],n=Math.PI*this.values[2]/180,u=Math.cos(n),f=Math.sin(n),x=s*s*t*t*u*u+e*e*t*t*f*f,c=2*o*t*u*f*(s*s-e*e),w=e*e*o*o*u*u+s*s*o*o*f*f,L=-(e*e*s*s*o*o*t*t),p=c*c-4*x*w,z=Math.sqrt((x-w)*(x-w)+c*c);this.values[2]=c!==0?Math.atan((w-x-z)/c)*180/Math.PI:x<w?0:90,this.values[0]=-Math.sqrt(2*p*L*(x+w+z))/p,this.values[1]=-Math.sqrt(2*p*L*(x+w-z))/p,this.values[5]*=o,this.values[6]*=t,this.values[4]=o*t>=0?this.values[4]:1-this.values[4]}refreshAbsolutePoints(o,t){this.previousPoint=t?t.targetLocation():new g(0,0),this.relative?this.absolutePoints=[new M(this.values[5]+this.previousPoint.x,this.values[6]+this.previousPoint.y)]:this.absolutePoints=[new M(this.values[5],this.values[6])]}asString(o=4,t=!1,e=[]){if(t){const s=[this.values,...e.map(n=>n.values)].map(n=>n.map(u=>mt(u,o,t))).map(n=>`${n[0]} ${n[1]} ${n[2]} ${n[3]}${n[4]}${n[5]} ${n[6]}`);return[this.getType(),...s].join(" ")}else return super.asString(o,t,e)}}O.key="A";const se={class:"flex flex-col w-screen h-screen bg-[var(--canvas-bg)] text-[var(--canvas-text)]",style:{"background-image":"var(--main-background-image)"}},ne=["onClick"],ae={class:"flex-1 flex flex-row gap-1"},ie={class:"max-w-4 w-4"},le={class:"w-8"},re=["value","onInput"],ce={class:"w-full h-full flex flex-row justify-around items-center"},ue={class:"w-1/4 h-full flex flex-col rounded-xl justify-center items-center cursor-pointer hover:bg-[var(--panel-hover-bg-color)]"},he=b("div",{i:"carbon-sun dark:carbon-moon"},null,-1),ve=b("div",null,"edit",-1),fe=[he,ve],de=gt({__name:"index",setup(v){const o=y(100),t=y(100);let e=Ht({viewPortX:0,viewPortY:0,viewPortWidth:0,viewPortHeight:0}),s=y(0);const n=y(null),{width:u,height:f}=vt(n);Q([u,f],()=>{o.value=u.value,t.value=f.value,N(e.viewPortX,e.viewPortY,e.viewPortWidth,null,!0)});const{Ctrl:x}=Xt();let c=!1;Q(x,a=>{c=a}),ft(()=>{setTimeout(()=>{z()},0)});const w=y("M 4 8 L 10 1 L 13 0 L 12 3 L 5 9 C 6 10 6 11 7 10 C 7 11 8 12 7 12 A 1.42 1.42 0 0 1 6 13 A 5 5 0 0 0 4 10 Q 3.5 9.9 3.5 10.5 T 2 11.8 T 1.2 11 T 2.5 9.5 T 3 9 A 5 5 90 0 0 0 7 A 1.42 1.42 0 0 1 1 6 C 1 5 2 6 3 6 C 2 7 3 7 4 8 M 10 1 L 10 3 L 12 3 L 10.2 2.8 L 10 1"),L=y(w.value),p=y();function z(){const a=Ct(L.value),i=t.value/o.value;let l=a.width+2,r=a.height+2;i<r/l?l=r/i:r=i*l,N(a.x-1,a.y-1,l,r)}function Ct(a){const i="http://www.w3.org/2000/svg",l=document.createElementNS(i,"svg");l.style.position="absolute",l.style.width="0px",l.style.height="0px";const r=document.createElementNS(i,"path");r.setAttributeNS(null,"d",a),l.appendChild(r),document.body.appendChild(l);const d=r.getBBox();return l.remove(),d}function N(a,i,l,r,d=!1){l===null&&r!==null&&(l=o.value*r/t.value),r===null&&l!==null&&(r=t.value*l/o.value),!(!l||!r)&&(e.viewPortX=parseFloat((1*a).toPrecision(6)),e.viewPortY=parseFloat((1*i).toPrecision(6)),e.viewPortWidth=parseFloat((1*l).toPrecision(4)),e.viewPortHeight=parseFloat((1*r).toPrecision(4)),s.value=e.viewPortWidth/o.value)}G(n,"wheel",a=>{if(a.preventDefault(),!c)return!1;const i=Math.pow(1.005,a.deltaY),l=$(a);kt(i,l)});function kt(a,i){i||(i={x:e.viewPortX+.5*e.viewPortWidth,y:e.viewPortY+.5*e.viewPortHeight});let l=e.viewPortX+(i.x-e.viewPortX-a*(i.x-e.viewPortX)),r=e.viewPortY+(i.y-e.viewPortY-a*(i.y-e.viewPortY)),d=a*e.viewPortWidth,m=a*e.viewPortHeight;N(l,r,d,m)}let F=null;G(n,"mousedown",a=>{F=a}),G(n,"mouseup",a=>{St()}),G(n,"mousemove",a=>{Lt(a)});function $(a,i=0){const{top:l,left:r}=vt(n),d=a instanceof MouseEvent?a:a.touches[i],m=e.viewPortX+(d.clientX-r.value)*s.value,k=e.viewPortY+(d.clientY-l.value)*s.value;return{x:m,y:k}}function Lt(a){const i=$(a),l=_t(F,a);if(j.value&&p.value)i.x=parseFloat(i.x.toFixed(0)),i.y=parseFloat(i.y.toFixed(0)),p.value.setLocation(j.value,i),tt(),F=null;else if(F){if(!c)return!1;if(l!==null){const r=l.zoom*e.viewPortWidth,d=l.zoom*e.viewPortHeight,m=e.viewPortX+l.delta.x+(l.center.x-e.viewPortX)*(1-l.zoom),k=e.viewPortY+l.delta.y+(l.center.y-e.viewPortY)*(1-l.zoom);N(m,k,r,d)}else{const r=$(F);let d=e.viewPortX+(r.x-i.x),m=e.viewPortY+(r.y-i.y),k=e.viewPortWidth,P=e.viewPortHeight;N(d,m,k,P)}F=a}}function _t(a,i){if(window.TouchEvent&&a instanceof TouchEvent&&i instanceof TouchEvent&&a.touches.length>=2&&i.touches.length>=2){const l=$(i,0),r=$(i,1),d=$(a,0),m=$(a,1),k={x:.5*(l.x+r.x),y:.5*(l.y+r.y)},P={x:.5*(d.x+m.x),y:.5*(d.y+m.y)},R={x:P.x-k.x,y:P.y-k.y};return{zoom:Math.sqrt((d.x-m.x)*(d.x-m.x)+(d.y-m.y)*(d.y-m.y))/Math.sqrt((l.x-r.x)*(l.x-r.x)+(l.y-r.y)*(l.y-r.y)),delta:R,center:k}}return null}function St(){F=null,j.value=null,I.value=null}const it=y(),lt=y(),j=y(),I=y(),J=y();ft(()=>{setTimeout(()=>{Mt(L.value)},0)});function Mt(a,i){rt(a,!0)}function rt(a,i=!1){J.value=null,I.value=null;try{L.value=a,p.value=new pt(L.value),ct(),i&&z()}catch{p.value||(p.value=new pt(""))}}function ct(){it.value=p.value.targetLocations(),lt.value=p.value.controlLocations()}function tt(){ct(),L.value=p.value.asString(4,!1)}let et=!1;const U=y();Q(()=>L.value,a=>{U.value=a},{immediate:!0});const At=()=>{et=!0},Tt=()=>{et=!1};Q(()=>U.value,()=>{et&&rt(U.value,!1)});const ut=y();Q(()=>p.value,()=>{ut.value=p.value.path});const Et=(a,i,l)=>{let r=Number(a.srcElement.value);isNaN(r)||(i.values[l]=Number(r),p.value.refreshAbsolutePositions(),tt())},Ft=a=>{I.value=a},$t=a=>p.value.path.indexOf(a)>0,It=a=>{I.value=null,p.value.delete(a),tt()};return(a,i)=>{const l=jt,r=Gt,d=qt,m=Ut,k=Rt("n-config-provider");return W(),Bt(k,{theme:Y(Nt)},{default:V(()=>[b("div",se,[A(Zt),b("div",{ref_key:"canvas",ref:n,class:"w-full h-full min-w-10 overflow-hidden"},[A(l,{viewPortWidth:Y(e).viewPortWidth,viewPortHeight:Y(e).viewPortHeight,viewPortX:Y(e).viewPortX,viewPortY:Y(e).viewPortY,strokeWidth:Y(s),canvasWidth:o.value,canvasHeight:t.value,parsedPath:p.value,targetPoints:it.value,controlPoints:lt.value,draggedPoint:j.value,"onUpdate:draggedPoint":i[0]||(i[0]=P=>j.value=P),focusedItem:I.value,"onUpdate:focusedItem":i[1]||(i[1]=P=>I.value=P),hoveredItem:J.value,"onUpdate:hoveredItem":i[2]||(i[2]=P=>J.value=P)},null,8,["viewPortWidth","viewPortHeight","viewPortX","viewPortY","strokeWidth","canvasWidth","canvasHeight","parsedPath","targetPoints","controlPoints","draggedPoint","focusedItem","hoveredItem"])],512),A(Kt,null,{path:V(()=>[A(r,{class:"w-full overflow-auto cursor-default",title:"Svg"},{default:V(()=>[xt(b("textarea",{class:"resize border rounded-md w-5/6 border-0 p-2 bg-[var(--input-bg-color)] text-[var(--input-text-color)]","onUpdate:modelValue":i[3]||(i[3]=P=>U.value=P),onBlur:Tt,onFocus:At},null,544),[[Dt,U.value]])]),_:1})]),command:V(()=>[A(r,{class:"w-full overflow-auto cursor-default",title:"Matrix"}),A(r,{class:"w-full overflow-auto cursor-default",title:"Command"},{default:V(()=>[(W(!0),H(st,null,ot(ut.value,P=>(W(),H("div",{class:"flex-center gap-2 m-2 p-2 rounded-md hover:bg-[var(--panel-hover-bg-color)]",style:Qt({background:I.value==P?"var(--panel-button-active-bg-color)":""}),onClick:R=>Ft(P)},[b("div",ae,[b("div",ie,wt(P.getType()),1),(W(!0),H(st,null,ot(P.values,(R,ht)=>(W(),H("div",le,[b("input",{type:"text",style:{"font-size":"10px",outline:"none"},class:"w-full text-center bg-[var(--input-bg-color)] border-0",value:R,onInput:Wt=>Et(Wt,P,ht)},null,40,re)]))),256))]),A(d,{onDelete:R=>It(P),canDelete:$t(P)},null,8,["onDelete","canDelete"])],12,ne))),256))]),_:1})]),button:V(()=>[b("div",ce,[(W(),H(st,null,ot(4,()=>b("div",ue,fe)),64))])]),_:1}),A(m,{class:"absolute left-[calc(50%-80px)] bottom-0"})])]),_:1},8,["theme"])}}});typeof dt=="function"&&dt(de);export{de as default};
